<!DOCTYPE html>
<html>
    <head>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    </head>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <meta name="google-signin-client_id" content="237590623451-kf3ebb1vinlp75ari43mbs667afeba4t.apps.googleusercontent.com">

<body>

<h2>HTML Forms</h2>

<form method="POST" onsubmit="login();">
  UserName:<br>
  <input type="text" name="username" id="username">
  <br>
  Password:<br>
  <input type="password" name="lastname" id="password">
  <br><br>
  <input type="submit" value="Submit">
</form> 

<p>If you click the "Submit" button, the form-data will be sent to a page called "/action_page.php".</p>

<br>
<div class="g-signin2" data-onsuccess="onSignIn"></div>
<br>
<a href="#" onclick="signOut();">Sign out</a>



    <script>
        
    function login() {
    event.preventDefault()
    const username = $('#username').val()
    const password = $('#password').val()
    
    $.ajax({
            url: 'http://localhost:3001/users/login',
            method: 'POST',
            data: { username, password }
        })
        .done(response => {
            alert('You Successfully Login')
        })
        .fail((jqXHR, textstatus) => {
            console.log('fail', textstatus)
        })
        
}   

function onSignIn(googleUser) {
  var profile = googleUser.getBasicProfile();
  console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
  console.log('Name: ' + profile.getName());
  console.log('Image URL: ' + profile.getImageUrl());
  console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
  
        $.post('http://localhost:3001/users/login', { token: id_token })
        .done((response) => {
            localStorage.setItem('token', response)
        })
        .fail((jqXHR, textstatus) => {
            console.log('fail', textstatus)
        })
};

function signOut() {
    var auth2 = gapi.auth2.getAuthInstance();
    auth2.signOut().then(function () {
      console.log('User signed out.');
    });
  }
    
    </script>

</body>
</html>